---
# Push Rules Configuration
# This file defines mandatory pre-push validation checks.
# Enforced by Claude Code hooks before allowing git push.

version: "1.0"
enabled: true
bypass_flag: "--skip-push-rules"

rebase_policy:
  enforcement: strict
  base_branch: main
  allow_merge_commits: false

lint:
  required: true
  command: "uv run ruff check ."
  allow_warnings: false
  timeout: 120

test:
  required: true
  command: "uv run pytest tests/ -x -q"
  timeout: 300

branch_naming_pattern: "^(feature|fix|docs|refactor|test|chore)/[a-z0-9-]+$"
enforce_branch_naming: true

janitor_settings:
  run_after_validation: true
  prune_merged_branches: true
  clean_stale_worktrees: true
  protected_branches:
    - main
    - master
    - develop
---

# Git Push Rules

This file defines mandatory checks that must pass before pushing code to the remote repository. These rules are enforced by Claude Code hooks and help maintain code quality.

## Rebase Policy

All branches MUST be rebased on the base branch before pushing. Merge commits pollute git history and are NOT allowed.

- **Enforcement**: strict
- **Base Branch**: main
- **Allow Merge Commits**: false

> **Why?** Rebasing keeps a clean, linear git history that is easier to read, bisect, and revert. Merge commits create "bubble" patterns that obscure the actual changes.

## Validation Requirements

### Linting

Static analysis must pass before pushing. This catches style issues, unused imports, and potential bugs early.

- **Required**: true
- **Command**: `uv run ruff check .`
- **Allow Warnings**: false
- **Timeout**: 120

> **Tip**: Run `uv run ruff check . --fix` to auto-fix most issues.

### Testing

All tests must pass before pushing. This prevents broken code from reaching the remote.

- **Required**: true
- **Command**: `uv run pytest tests/ -x -q`
- **Minimum Coverage**: 0
- **Timeout**: 300

> **Note**: Set `Minimum Coverage` to 80 to enforce coverage requirements.

## Branch Naming Convention

Branch names must follow the project's naming convention for clarity and automation.

- **Pattern**: `^(feature|fix|docs|refactor|test|chore)/[a-z0-9-]+$`
- **Enforce**: true

**Valid examples**:
- `feature/add-push-rules`
- `fix/hook-timeout`
- `docs/update-readme`
- `refactor/simplify-validation`

**Invalid examples**:
- `my-branch` (missing prefix)
- `Feature/Add-Rules` (uppercase not allowed)
- `feature/add_rules` (underscores not allowed)

## Janitor Settings

Post-validation cleanup settings for the github-janitor agent.

- **Run After Validation**: true
- **Prune Merged Branches**: true
- **Clean Stale Worktrees**: true
- **Protected Branches**: main, master, develop

> **Note**: Janitor runs automatically after `/jpspec:validate` Phase 7.

---

## Customization

Edit the YAML frontmatter at the top of this file to customize rules for your project. Common customizations:

### Disable a check temporarily
```yaml
enabled: false  # Disable all push rules
```

### Use different lint command
```yaml
lint:
  command: "npm run lint"
```

### Strict coverage enforcement
```yaml
# Set Minimum Coverage: 80
```

### Allow merge commits for specific repos
```yaml
# Set Allow Merge Commits: true
```

---

*Generated by JP Spec Kit. See docs/guides/push-rules-configuration.md for details.*
