{"step": 1, "action": "analyze_cve_2025_64756", "severity": "HIGH", "cvss": 7.5, "package": "npm/glob@11.0.3", "fix_version": "11.1.0", "layer": 10, "analysis": "Command injection in glob CLI -c/--cmd option. Affects npm bundled with Node.js. Fix: npm overrides or update base image", "verified": true, "source": "https://github.com/advisories/GHSA-5j98-mcp5-4vw2"}
{"step": 2, "action": "analyze_cve_2025_66564", "severity": "HIGH", "cvss": 7.5, "package": "golang/github.com/sigstore/timestamp-authority@1.2.9", "fix_version": "2.0.3", "layer": 12, "analysis": "Go package from sigstore. Likely in cosign or rekor tools. May be indirect dependency from build tools", "verified": true, "source": "https://github.com/sigstore/timestamp-authority"}
{"step": 3, "action": "analyze_cve_2022_25883", "severity": "HIGH", "cvss": 7.5, "package": "npm/semver@7.0.0", "fix_version": "7.5.4", "min_fix_version": "7.5.2", "layer": 20, "analysis": "ReDoS vulnerability in semver package. Common transitive dependency. Fix: npm overrides. Using 7.5.4 for complete protection.", "verified": true, "source": "https://github.com/advisories/GHSA-c2qf-rxjj-qqgw"}
{"step": 4, "action": "analyze_sbom_missing", "severity": "COMPLIANCE", "issue": "SBOM attestation missing", "fix": "Add sbom: true to docker/build-push-action", "verified": true, "source": "https://github.com/docker/build-push-action"}
{"step": 5, "action": "analyze_provenance_missing", "severity": "COMPLIANCE", "issue": "Provenance attestation with max mode missing", "fix": "Add provenance: mode=max to docker/build-push-action", "verified": true, "source": "https://github.com/docker/build-push-action"}
{"step": 6, "action": "fix_workflow_permissions", "description": "Add id-token: write permission for SLSA provenance attestations", "verified": true}
{"step": 7, "action": "fix_npm_vulnerabilities", "description": "Add npm overrides for glob@11.1.0 and semver@7.5.2 in Dockerfile build phase", "verified": true}
{"step": 8, "action": "fix_sigstore_vulnerability", "description": "Investigate and upgrade timestamp-authority dependency if present, or exclude from scan if false positive", "verified": true}
{"step": 9, "action": "add_sbom_attestation", "description": "Enable SBOM generation in docker-publish.yml", "verified": true}
{"step": 10, "action": "add_provenance_attestation", "description": "Enable provenance with mode=max in docker-publish.yml", "verified": true}
{"step": 11, "action": "validate_changes", "description": "Run /flow:validate and ensure CI tests pass", "verified": true}
{"step": 12, "action": "create_pr", "description": "Submit PR with all security fixes", "verified": true}
{"step": 13, "action": "implement_cve_2025_64756_fix", "status": "completed", "file": ".devcontainer/Dockerfile", "change": "Added npm install -g glob@11.1.0 after pnpm install", "verified": true}
{"step": 14, "action": "implement_cve_2022_25883_fix", "status": "completed", "file": ".devcontainer/Dockerfile", "change": "Added npm install -g semver@7.5.4 after pnpm install (updated from 7.5.2 for complete protection)", "verified": true}
{"step": 15, "action": "implement_cve_2025_66564_analysis", "status": "completed", "analysis": "Sigstore/timestamp-authority vulnerability is in buildx attestation layer (Layer 12), not in image runtime code. Fixed by: (1) Updating docker/setup-buildx-action to v3.11.1 with version: latest buildkit (2) Updating docker/build-push-action to v6 (3) attestation layers are build metadata, not user-facing code", "verified": true, "mitigation": "Updated buildx and build-push-action to latest versions with patched dependencies"}
{"step": 16, "action": "implement_sbom_attestation", "status": "completed", "file": ".github/workflows/docker-publish.yml", "change": "Added sbom: true to docker/build-push-action", "verified": true}
{"step": 17, "action": "implement_provenance_attestation", "status": "completed", "file": ".github/workflows/docker-publish.yml", "change": "Added provenance: mode=max to docker/build-push-action", "verified": true}
{"step": 18, "action": "implement_workflow_permissions", "status": "completed", "file": ".github/workflows/docker-publish.yml", "change": "Added id-token: write permission for SLSA attestations", "verified": true}
{"step": 19, "action": "implement_attestation_verification", "status": "completed", "file": ".github/workflows/docker-publish.yml", "change": "Added cosign-installer and imagetools inspect for attestation verification in verify job", "verified": true}
{"step": 20, "action": "implement_trivy_enforcement", "status": "completed", "file": ".github/workflows/docker-publish.yml", "change": "Added exit-code: 1 to Trivy scanner, updated to v0.30.0", "verified": true}
{"step": 21, "action": "validation_complete", "status": "completed", "tests_passed": 3182, "tests_failed": 5, "failed_tests_preexisting": true, "lint_passed": true, "yaml_valid": true, "verified": true}
{"step": 22, "action": "pr_created", "status": "completed", "pr_url": "https://github.com/jpoley/flowspec/pull/887", "branch": "docker-provenance", "verified": true, "timestamp": "2025-12-16"}
