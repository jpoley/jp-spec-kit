{"timestamp": "2024-12-16T00:00:00Z", "phase": "analysis", "type": "vulnerability_assessment", "cve": "CVE-2025-64756", "package": "glob", "current_version": "11.0.3", "fix_version": "11.1.0", "severity": "HIGH", "description": "Command injection vulnerability in glob package", "decision": "Upgrade glob to 11.1.0 via npm install -g"}
{"timestamp": "2024-12-16T00:01:00Z", "phase": "analysis", "type": "vulnerability_assessment", "cve": "CVE-2022-25883", "package": "semver", "current_version": "7.0.0", "fix_version": "7.5.4", "severity": "HIGH", "description": "ReDoS vulnerability in semver package, fix available in 7.5.2+, recommended 7.5.4", "decision": "Upgrade semver to 7.5.4 via npm install -g"}
{"timestamp": "2024-12-16T00:02:00Z", "phase": "analysis", "type": "vulnerability_assessment", "cve": "CVE-2025-66564", "package": "sigstore/timestamp-authority", "current_version": "buildx-embedded", "fix_version": "buildx-latest", "severity": "HIGH", "description": "Vulnerability in sigstore timestamp-authority embedded in buildx attestation layer", "decision": "Use docker/setup-buildx-action@v3.11.1 with version: latest to get patched buildkit"}
{"timestamp": "2024-12-16T00:03:00Z", "phase": "analysis", "type": "supply_chain_gap", "gap": "missing_sbom", "description": "Docker Hub reports missing SBOM attestation", "decision": "Add sbom: true to docker/build-push-action"}
{"timestamp": "2024-12-16T00:04:00Z", "phase": "analysis", "type": "supply_chain_gap", "gap": "missing_provenance_max", "description": "Docker Hub reports missing SLSA provenance attestation with max mode", "decision": "Add provenance: mode=max to docker/build-push-action"}
{"timestamp": "2024-12-16T00:05:00Z", "phase": "implementation", "type": "dockerfile_fix", "file": ".devcontainer/Dockerfile", "changes": ["Added npm install -g glob@11.1.0 semver@7.5.4 after pnpm install", "Added npm cache clean --force for cleanup"], "rationale": "Fix CVE-2025-64756 and CVE-2022-25883 by upgrading vulnerable npm packages"}
{"timestamp": "2024-12-16T00:06:00Z", "phase": "implementation", "type": "workflow_fix", "file": ".github/workflows/docker-publish.yml", "changes": ["Added id-token: write permission for OIDC attestation signing", "Set docker/setup-buildx-action@v3.11.1 with version: latest", "Added sbom: true to build-push-action", "Added provenance: mode=max to build-push-action", "Added job outputs for image-ref to pass to verify job"], "rationale": "Enable SLSA provenance and SBOM generation with latest buildkit to fix CVE-2025-66564"}
{"timestamp": "2024-12-16T00:07:00Z", "phase": "implementation", "type": "verification_step", "file": ".github/workflows/docker-publish.yml", "changes": ["Added verify job with cosign attestation verification", "Using sigstore/cosign-installer@v3.7.0", "Verifying SBOM attestation with --type spdxjson", "Verifying Provenance attestation with --type slsaprovenance"], "rationale": "Cryptographically verify attestations are properly signed and contain required fields"}
{"timestamp": "2024-12-16T00:08:00Z", "phase": "security_hardening", "type": "identity_verification", "file": ".github/workflows/docker-publish.yml", "changes": ["certificate-identity-regexp: ^https://github\\.com/jpoley/flowspec/\\.github/workflows/docker-publish\\.yml@refs/heads/main$", "certificate-oidc-issuer: https://token.actions.githubusercontent.com"], "rationale": "Use explicit identity patterns instead of wildcards (.*) to ensure only this specific workflow can produce valid attestations"}
{"timestamp": "2024-12-16T00:09:00Z", "phase": "validation", "type": "attestation_structure", "checks": ["Verify payload field exists in attestation", "Validate spdxVersion present in SBOM", "Validate packages array present in SBOM", "Validate buildDefinition present in provenance", "Validate runDetails present in provenance"], "rationale": "Structural validation ensures attestations are not malformed and contain required SLSA/SPDX fields"}
{"timestamp": "2024-12-16T00:10:00Z", "phase": "iteration_log", "type": "pr_history", "iterations": [{"pr": 887, "issue": "semver version 7.5.2 instead of 7.5.4", "action": "closed"}, {"pr": 888, "issue": "superficial attestation verification (print only)", "action": "closed"}, {"pr": 889, "issue": "wildcard patterns (.*) defeat cryptographic verification", "action": "closed"}, {"pr": 890, "issue": "missing DCO sign-off", "action": "closed"}, {"pr": 891, "issue": "env var scope issue and Trivy exit-code breaking change", "action": "closed"}], "current_pr": "docker-provenance-v6", "lesson": "Always create new PR when fixing mistakes, never amend"}
{"timestamp": "2024-12-16T00:11:00Z", "phase": "fix", "type": "env_var_scope", "issue": "IMAGE_REF environment variable uses env.REGISTRY and env.IMAGE_NAME but these workflow-level vars not accessible in verify job", "solution": "1. Define REGISTRY and IMAGE_NAME at job level in verify job, 2. Pass image-ref as job output from build-and-push to verify job", "rationale": "GitHub Actions env vars defined at workflow level may not be accessible in all job contexts"}
{"timestamp": "2024-12-16T00:12:00Z", "phase": "fix", "type": "trivy_behavior", "issue": "Setting exit-code to 1 without removing continue-on-error would be breaking change from previous behavior", "solution": "Keep continue-on-error: true as it was in original workflow, add comment explaining this is intentional for visibility without blocking builds", "rationale": "Preserve existing CI behavior - Trivy results uploaded to Security tab for visibility but do not block builds"}
